---
title: "DATA_621_HW1"
author: "Euclid Zhang"
date: "1/30/2022"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r include=FALSE}
library("corrplot")
```

```{r}
train_raw_df <- read.csv("https://raw.githubusercontent.com/ezaccountz/DATA_621/main/HW1/moneyball-training-data.csv")
test_raw_df <- read.csv("https://raw.githubusercontent.com/ezaccountz/DATA_621/main/HW1/moneyball-evaluation-data.csv")

train_raw_df$INDEX <- NULL
test_raw_df$INDEX <- NULL
```


# DATA EXPLORATION

```{r}
summary(train_raw_df)
```
## * **Outliers**

From the summaries The maximum values for TEAM_PITCHING_H, TEAM_PITCHING_BB, TEAM_PITCHING_SO and TEAM_FIELDING_E seem abnormally large. There may be outliers in the columns. We can confirm this finding by checking the distributions of the values:

```{r fig.height=10, fig.width=10}
par(mfrow=c(4,4))
for(i in c(1:16)) {
  boxplot(train_raw_df[,i],main=colnames(train_raw_df)[i])
}
```
From the boxplots, there are indeed values in TEAM_PITCHING_H, TEAM_PITCHING_BB, TEAM_PITCHING_SO and TEAM_FIELDING_E that are extremly off from the majority of the data. We would handle these outliers later with the other problems.
  


## * **Missing values**

From the summaries, we see that are are missing values for TEAM_BATTING_SO, TEAM_BASERUN_SB, TEAM_BASERUN_CS, EAM_BATTING_HBP, TEAM_PITCHING_SO, and TEAM_FIELDING_DP. Now we check the portion of missing data in each field:

```{r}
sapply(train_raw_df,function(x)sum(is.na(x)))/nrow(train_raw_df)
```
91.6% of the data in TEAM_BATTING_HBP are missing. Since the minimum of TEAM_BATTING_HBP is 29, it is not plausible that the missing values are all 0. We will drop this field from our analysis as there are too many missing values and there is no good way of imputing the values.
  
For TEAM_BATTING_SO, TEAM_BASERUN_SB, TEAM_BASERUN_CS, TEAM_PITCHING_SO, and TEAM_FIELDING_DP, we will do imputation and may be handled with other problems.
  




## * **Correlations**

Now let's look at the correlations between the variables  
```{r fig.height=10, fig.width=10}
corrplot(cor(train_raw_df, use = "na.or.complete"), method = 'number', type = 'lower', diag = FALSE, tl.srt = 0.1)
```
**The following variables are nearly perfectly correlated**  

* TEAM_BATTING_H and TEAM_PITCHING_H
* TEAM_BATTING_HR and TEAM_PITCHING_HR
* TEAM_BATTING_BB and TEAM_PITCHING_BB
* TEAM_BATTING_SO and TEAM_PITCHING_SO

  

We take a more careful look at the correlation between the TARGET_WINS and other variables, and compare it with the theoretical effects
```{r paged.print=FALSE}
corr_table <- data.frame(correlation_with_TARGET_WINS = round(cor(train_raw_df, use = "na.or.complete"),4)[-1,"TARGET_WINS"])
corr_table$Theoretical_Effect <- c("Positive","Positive","Positive","Positive","Positive","Negative","Positive","Negative","Positive","Negative","Negative","Negative","Positive","Negative","Positive")
corr_table
```
**The following variables do not have correlation matching with the theoretical effect:  

* TEAM_BATTING_3B
* TEAM_PITCHING_H
* TEAM_PITCHING_HR
* TEAM_PITCHING_BB
* TEAM_PITCHING_SO
* TEAM_FIELDING_DP  
  
For TEAM_BATTING_3B and TEAM_FIELDING_DP, we would need to perform deeper analysis on this finding.  
For TEAM_PITCHING_H, TEAM_PITCHING_HR, TEAM_PITCHING_BB, TEAM_PITCHING_SO, we may consider dropping the variables since they are amlost perfectly correlated with one other variable. Also, TEAM_PITCHING_H, TEAM_PITCHING_BB and TEAM_PITCHING_SO have outlier problem as found above.

## * **normalities**

We check the normalities of the variables to determine if transformation is needed.  
```{r fig.height=10, fig.width=10}
par(mfrow=c(4,4))
for(i in c(1:16)) {
  plot(density(train_raw_df[,i],na.rm=TRUE),main=colnames(train_raw_df)[i])
}
```
TEAM_PITCHING_H, TEAM_PITCHING_BB, TEAM_PITCHING_SO and TEAM_FIELDING_E are largely right skewed because of the outliers. We will check the distributions later again when the outliers are handled.  
TEAM_BATTING_HR, TEAM_BATTING_SO, TEAM_PITCHING_HR are bimodal that may need to be transformed.  
There are some variables such as TEAM_BASERUN_SB that are slightly right skewed. We may keep them as it for easier interpretation of the result.



# DATA PREPARATION

```{r}

```



```{r}

```



```{r}
215
```



```{r}

```



```{r}

```



```{r}

```



```{r}

```



```{r}

```



```{r}

```



```{r}

```



```{r}

```



```{r}

```



```{r}

```



```{r}

```



```{r}

```



```{r}

```



```{r}

```



```{r}

```
